var __webpack_modules__ = {
  "./src/打开滚动新消息不滚动/index.ts"() {
    eval("{\n/**\n * 打开滚动新消息不滚动\n *\n * 功能：\n * - 刚打开一个角色卡时，自动滚动到最新的楼层\n * - 后续接收到新消息时，不会自动滚动，保持用户当前浏览位置\n *\n * 使用前提：\n * - 请在酒馆设置中关闭\"自动滚动到新消息\"选项\n * - 本脚本会接管滚动行为，只在打开角色卡时滚动一次\n */\n// 标记是否刚打开聊天（初次加载状态）\nlet isInitialLoad = true;\n// 监听聊天切换事件 - 当用户打开新角色卡或切换聊天时触发\neventOn(tavern_events.CHAT_CHANGED, () => {\n    // 重置为初次加载状态，允许下次滚动\n    isInitialLoad = true;\n    console.log('[打开滚动新消息不滚动] 检测到聊天切换，准备在消息加载完成后滚动到底部');\n});\n// 监听消息渲染事件 - 只在首次加载时滚动到底部\neventOn(tavern_events.CHARACTER_MESSAGE_RENDERED, () => {\n    if (isInitialLoad) {\n        // 延迟一点确保所有消息都渲染完成\n        setTimeout(() => {\n            const $chat = $('#chat');\n            if ($chat.length && $chat[0]) {\n                $chat.scrollTop($chat[0].scrollHeight);\n                console.log('[打开滚动新消息不滚动] 已滚动到聊天底部');\n                // 标记初次加载完成，后续不再自动滚动\n                isInitialLoad = false;\n            }\n        }, 150);\n    }\n});\n// 监听用户消息渲染事件 - 首次加载时也要滚动\neventOn(tavern_events.USER_MESSAGE_RENDERED, () => {\n    if (isInitialLoad) {\n        setTimeout(() => {\n            const $chat = $('#chat');\n            if ($chat.length && $chat[0]) {\n                $chat.scrollTop($chat[0].scrollHeight);\n                console.log('[打开滚动新消息不滚动] 已滚动到聊天底部');\n                // 标记初次加载完成\n                isInitialLoad = false;\n            }\n        }, 150);\n    }\n});\n// 脚本加载提示 - 只在首次启用时显示一次\n$(() => {\n    console.log('[打开滚动新消息不滚动] 脚本已加载');\n    // 检查是否已经显示过提示\n    const storageKey = 'script_打开滚动新消息不滚动_first_load_tip_shown';\n    const hasShownTip = localStorage.getItem(storageKey);\n    if (!hasShownTip) {\n        // 首次加载，显示提示并记录\n        toastr.success('请确保已关闭酒馆设置中的\"自动滚动\"选项\\n打开角色卡时会自动滚动到底部，后续不会自动滚动', '打开滚动新消息不滚动', { timeOut: 5000 });\n        localStorage.setItem(storageKey, 'true');\n    }\n});\n// 脚本卸载提示\n$(window).on('pagehide', () => {\n    console.log('[打开滚动新消息不滚动] 脚本已卸载');\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5omT5byA5rua5Yqo5paw5raI5oGv5LiN5rua5YqoL2luZGV4LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7OztHQVVHO0FBRUgsb0JBQW9CO0FBQ3BCLElBQUksYUFBYSxHQUFHLElBQUksQ0FBQztBQUV6QiwrQkFBK0I7QUFDL0IsT0FBTyxDQUFDLGFBQWEsQ0FBQyxZQUFZLEVBQUUsR0FBRyxFQUFFO0lBQ3ZDLG1CQUFtQjtJQUNuQixhQUFhLEdBQUcsSUFBSSxDQUFDO0lBQ3JCLE9BQU8sQ0FBQyxHQUFHLENBQUMsc0NBQXNDLENBQUMsQ0FBQztBQUN0RCxDQUFDLENBQUMsQ0FBQztBQUVILDBCQUEwQjtBQUMxQixPQUFPLENBQUMsYUFBYSxDQUFDLDBCQUEwQixFQUFFLEdBQUcsRUFBRTtJQUNyRCxJQUFJLGFBQWEsRUFBRSxDQUFDO1FBQ2xCLGtCQUFrQjtRQUNsQixVQUFVLENBQUMsR0FBRyxFQUFFO1lBQ2QsTUFBTSxLQUFLLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3pCLElBQUksS0FBSyxDQUFDLE1BQU0sSUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztnQkFDN0IsS0FBSyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUM7Z0JBQ3ZDLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUJBQXVCLENBQUMsQ0FBQztnQkFDckMsb0JBQW9CO2dCQUNwQixhQUFhLEdBQUcsS0FBSyxDQUFDO1lBQ3hCLENBQUM7UUFDSCxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDVixDQUFDO0FBQ0gsQ0FBQyxDQUFDLENBQUM7QUFFSCx5QkFBeUI7QUFDekIsT0FBTyxDQUFDLGFBQWEsQ0FBQyxxQkFBcUIsRUFBRSxHQUFHLEVBQUU7SUFDaEQsSUFBSSxhQUFhLEVBQUUsQ0FBQztRQUNsQixVQUFVLENBQUMsR0FBRyxFQUFFO1lBQ2QsTUFBTSxLQUFLLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3pCLElBQUksS0FBSyxDQUFDLE1BQU0sSUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztnQkFDN0IsS0FBSyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUM7Z0JBQ3ZDLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUJBQXVCLENBQUMsQ0FBQztnQkFDckMsV0FBVztnQkFDWCxhQUFhLEdBQUcsS0FBSyxDQUFDO1lBQ3hCLENBQUM7UUFDSCxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDVixDQUFDO0FBQ0gsQ0FBQyxDQUFDLENBQUM7QUFFSCx1QkFBdUI7QUFDdkIsQ0FBQyxDQUFDLEdBQUcsRUFBRTtJQUNMLE9BQU8sQ0FBQyxHQUFHLENBQUMsb0JBQW9CLENBQUMsQ0FBQztJQUVsQyxjQUFjO0lBQ2QsTUFBTSxVQUFVLEdBQUcsd0NBQXdDLENBQUM7SUFDNUQsTUFBTSxXQUFXLEdBQUcsWUFBWSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUVyRCxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDakIsZUFBZTtRQUNmLE1BQU0sQ0FBQyxPQUFPLENBQ1osK0NBQStDLEVBQy9DLFlBQVksRUFDWixFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsQ0FDbEIsQ0FBQztRQUNGLFlBQVksQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQzNDLENBQUM7QUFDSCxDQUFDLENBQUMsQ0FBQztBQUVILFNBQVM7QUFDVCxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLFVBQVUsRUFBRSxHQUFHLEVBQUU7SUFDNUIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0FBQ3BDLENBQUMsQ0FBQyxDQUFDIiwic291cmNlcyI6WyJzcmM6Ly90YXZlcm5faGVscGVyX3RlbXBsYXRlL3NyYy/miZPlvIDmu5rliqjmlrDmtojmga/kuI3mu5rliqgvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDmiZPlvIDmu5rliqjmlrDmtojmga/kuI3mu5rliqhcbiAqXG4gKiDlip/og73vvJpcbiAqIC0g5Yia5omT5byA5LiA5Liq6KeS6Imy5Y2h5pe277yM6Ieq5Yqo5rua5Yqo5Yiw5pyA5paw55qE5qW85bGCXG4gKiAtIOWQjue7reaOpeaUtuWIsOaWsOa2iOaBr+aXtu+8jOS4jeS8muiHquWKqOa7muWKqO+8jOS/neaMgeeUqOaIt+W9k+WJjea1j+iniOS9jee9rlxuICpcbiAqIOS9v+eUqOWJjeaPkO+8mlxuICogLSDor7flnKjphZLppoborr7nva7kuK3lhbPpl61cIuiHquWKqOa7muWKqOWIsOaWsOa2iOaBr1wi6YCJ6aG5XG4gKiAtIOacrOiEmuacrOS8muaOpeeuoea7muWKqOihjOS4uu+8jOWPquWcqOaJk+W8gOinkuiJsuWNoeaXtua7muWKqOS4gOasoVxuICovXG5cbi8vIOagh+iusOaYr+WQpuWImuaJk+W8gOiBiuWkqe+8iOWIneasoeWKoOi9veeKtuaAge+8iVxubGV0IGlzSW5pdGlhbExvYWQgPSB0cnVlO1xuXG4vLyDnm5HlkKzogYrlpKnliIfmjaLkuovku7YgLSDlvZPnlKjmiLfmiZPlvIDmlrDop5LoibLljaHmiJbliIfmjaLogYrlpKnml7bop6blj5FcbmV2ZW50T24odGF2ZXJuX2V2ZW50cy5DSEFUX0NIQU5HRUQsICgpID0+IHtcbiAgLy8g6YeN572u5Li65Yid5qyh5Yqg6L2954q25oCB77yM5YWB6K645LiL5qyh5rua5YqoXG4gIGlzSW5pdGlhbExvYWQgPSB0cnVlO1xuICBjb25zb2xlLmxvZygnW+aJk+W8gOa7muWKqOaWsOa2iOaBr+S4jea7muWKqF0g5qOA5rWL5Yiw6IGK5aSp5YiH5o2i77yM5YeG5aSH5Zyo5raI5oGv5Yqg6L295a6M5oiQ5ZCO5rua5Yqo5Yiw5bqV6YOoJyk7XG59KTtcblxuLy8g55uR5ZCs5raI5oGv5riy5p+T5LqL5Lu2IC0g5Y+q5Zyo6aaW5qyh5Yqg6L295pe25rua5Yqo5Yiw5bqV6YOoXG5ldmVudE9uKHRhdmVybl9ldmVudHMuQ0hBUkFDVEVSX01FU1NBR0VfUkVOREVSRUQsICgpID0+IHtcbiAgaWYgKGlzSW5pdGlhbExvYWQpIHtcbiAgICAvLyDlu7bov5/kuIDngrnnoa7kv53miYDmnInmtojmga/pg73muLLmn5PlrozmiJBcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGNvbnN0ICRjaGF0ID0gJCgnI2NoYXQnKTtcbiAgICAgIGlmICgkY2hhdC5sZW5ndGggJiYgJGNoYXRbMF0pIHtcbiAgICAgICAgJGNoYXQuc2Nyb2xsVG9wKCRjaGF0WzBdLnNjcm9sbEhlaWdodCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdb5omT5byA5rua5Yqo5paw5raI5oGv5LiN5rua5YqoXSDlt7Lmu5rliqjliLDogYrlpKnlupXpg6gnKTtcbiAgICAgICAgLy8g5qCH6K6w5Yid5qyh5Yqg6L295a6M5oiQ77yM5ZCO57ut5LiN5YaN6Ieq5Yqo5rua5YqoXG4gICAgICAgIGlzSW5pdGlhbExvYWQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9LCAxNTApO1xuICB9XG59KTtcblxuLy8g55uR5ZCs55So5oi35raI5oGv5riy5p+T5LqL5Lu2IC0g6aaW5qyh5Yqg6L295pe25Lmf6KaB5rua5YqoXG5ldmVudE9uKHRhdmVybl9ldmVudHMuVVNFUl9NRVNTQUdFX1JFTkRFUkVELCAoKSA9PiB7XG4gIGlmIChpc0luaXRpYWxMb2FkKSB7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBjb25zdCAkY2hhdCA9ICQoJyNjaGF0Jyk7XG4gICAgICBpZiAoJGNoYXQubGVuZ3RoICYmICRjaGF0WzBdKSB7XG4gICAgICAgICRjaGF0LnNjcm9sbFRvcCgkY2hhdFswXS5zY3JvbGxIZWlnaHQpO1xuICAgICAgICBjb25zb2xlLmxvZygnW+aJk+W8gOa7muWKqOaWsOa2iOaBr+S4jea7muWKqF0g5bey5rua5Yqo5Yiw6IGK5aSp5bqV6YOoJyk7XG4gICAgICAgIC8vIOagh+iusOWIneasoeWKoOi9veWujOaIkFxuICAgICAgICBpc0luaXRpYWxMb2FkID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSwgMTUwKTtcbiAgfVxufSk7XG5cbi8vIOiEmuacrOWKoOi9veaPkOekuiAtIOWPquWcqOmmluasoeWQr+eUqOaXtuaYvuekuuS4gOasoVxuJCgoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdb5omT5byA5rua5Yqo5paw5raI5oGv5LiN5rua5YqoXSDohJrmnKzlt7LliqDovb0nKTtcblxuICAvLyDmo4Dmn6XmmK/lkKblt7Lnu4/mmL7npLrov4fmj5DnpLpcbiAgY29uc3Qgc3RvcmFnZUtleSA9ICdzY3JpcHRf5omT5byA5rua5Yqo5paw5raI5oGv5LiN5rua5YqoX2ZpcnN0X2xvYWRfdGlwX3Nob3duJztcbiAgY29uc3QgaGFzU2hvd25UaXAgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShzdG9yYWdlS2V5KTtcblxuICBpZiAoIWhhc1Nob3duVGlwKSB7XG4gICAgLy8g6aaW5qyh5Yqg6L2977yM5pi+56S65o+Q56S65bm26K6w5b2VXG4gICAgdG9hc3RyLnN1Y2Nlc3MoXG4gICAgICAn6K+356Gu5L+d5bey5YWz6Zet6YWS6aaG6K6+572u5Lit55qEXCLoh6rliqjmu5rliqhcIumAiemhuVxcbuaJk+W8gOinkuiJsuWNoeaXtuS8muiHquWKqOa7muWKqOWIsOW6lemDqO+8jOWQjue7reS4jeS8muiHquWKqOa7muWKqCcsXG4gICAgICAn5omT5byA5rua5Yqo5paw5raI5oGv5LiN5rua5YqoJyxcbiAgICAgIHsgdGltZU91dDogNTAwMCB9LFxuICAgICk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oc3RvcmFnZUtleSwgJ3RydWUnKTtcbiAgfVxufSk7XG5cbi8vIOiEmuacrOWNuOi9veaPkOekulxuJCh3aW5kb3cpLm9uKCdwYWdlaGlkZScsICgpID0+IHtcbiAgY29uc29sZS5sb2coJ1vmiZPlvIDmu5rliqjmlrDmtojmga/kuI3mu5rliqhdIOiEmuacrOW3suWNuOi9vScpO1xufSk7XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/打开滚动新消息不滚动/index.ts\n\n}");
  }
};

var __webpack_exports__ = {};

__webpack_modules__["./src/打开滚动新消息不滚动/index.ts"]();
